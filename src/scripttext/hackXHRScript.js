!function(){const e=XMLHttpRequest;XMLHttpRequest=function(){const t=new e,n=t.open;return t.open=function(e,a,...s){a.includes("badge_count/badge_count.json")&&(t.isBadge=!0,function(e){e.realResponse=null,e.resumeCallback=function(){},e.EventListenerCallback=[],e.resumeFlag=!1,e._hiddenId=Math.floor(Number.MAX_SAFE_INTEGER*Math.random()).toString().padStart(20,"0"),e._activeUser=!1,e._requestHeaders={};const t=e.setRequestHeader;e.setRequestHeader=function(n,a){return e._requestHeaders[n.toLowerCase()]=a,t.call(e,n,a)};const n=e.send;e.send=function(...t){if(e.isBadge){e._activeUser="yes"==e._requestHeaders["x-twitter-active-user"];const t=e.onreadystatechange||function(){};e.onreadystatechange=function(n){if(4==e.readyState){const a=JSON.parse(e.responseText);e.realResponse=a,e.resumeCallback=()=>t.call(e,n),e._activeUser?window.postMessage({type:"_BadgeIntercept",data:a,id:e._hiddenId},"*"):s()}else t.call(e,n)}}n.call(e,...t)};const a=e.addEventListener;function s(){e.resumeCallback(),e.resumeFlag=!1,e.EventListenerCallback.forEach(e=>{e()})}e.addEventListener=function(t,n,...s){if("readystatechange"===t){const r=function(t){4===e.readyState&&e.resumeFlag&&e.isBadge?e.EventListenerCallback.push(()=>n.call(e,t)):n.call(e,t)};return a.call(e,t,r,...s)}return a.call(e,t,n,...s)},window.addEventListener("message",t=>{t.source==window&&"_ResumeRequest"==t.data.type&&t.data.id==e._hiddenId&&s()})}(t)),n.call(t,e,a,...s)},t},XMLHttpRequest.prototype=e.prototype}();